
## Redis是什么？
 Redis ( Remote Dictionary Server ),即远程字典服务!

## Rdeis能干嘛？
- 内存存储、持久化,内存中是断电即失,所以说持久化很重要(rdb, aof)
- 效率高,可以用于高速缓存
- 发布订阅系统
- 地图信息分析
- 计时器、计数器(浏览量!)
- ......

## Redis默认有16个数据库

## Redis 是单线程的!
- Redis是很快的,官方表示,Redis是基于内存操作,CPU不是Redis性能瓶颈,Redis的瓶颈是根据机器的内存和网络带宽,既然可以使用单线程来实现,就使用单线程了!所以就使用了单线程了!
- Redis 是C语言写的,官方提供的数据为100000+的QPS,完全不比同样是使用key-vale的Memecache差!

## Redis 为什么单线程还这么快?
1、误区1:高性能的服务器一定是多线程的?
2、误区2:多线程(CPU上下文会切换!)一定比单线程效率高!
- CPU>内存>硬盘的速度要有所了解!
- 核心:redis是将所有的数据全部放在内存中的,所以说使用单线程去操作效率就是最高的,多线程(CPU上下文会切换:耗时的操作!!!),对于内存系统来说,如果没有上下文切换效率就是最高的!多次读写都是在一个CPU上的,在内存情况下,这个就是最佳的方案!

## Redis应用场景
- 用来做缓存(ehcache/memcached)——redis的所有数据是放在内存中的（内存数据库）
- 可以在某些特定应用场景下替代传统数据库——比如社交类的应用
- 在一些大型系统中，巧妙地实现一些特定的功能：session共享、购物车

## 五种常见数据类型
- 字符串string
- 哈希hash
- 列表list
- 集合set
- 有序集合zset

## 三种罕见数据类型
- geospatial
- hyperloglog
- bitmaps

## 分布式存储
1. 哈希取余分区
	- 分布式缓存数据变动和映射问题,某个机器岩机了,分母数量改变了,自然取余数不OK了。
2. 一致性哈希算法分区
	- 步骤：
		1. 算法构建一致性哈希环
		2. 服务器IP节点映射
		3. key落到服务器的落键规则
	- 优点：
		1. 致性哈希算法的容错性: 加入和删除节点只影响哈希环中顺时针方向的相邻的节点,对其他节点无影响。
		2. 致性哈希算法的扩展性
	- 缺点：数据倾斜问题
3. 哈希槽分区
	- 哈希槽实质就是一个数组,数组[0,2^14-1]形成hash slot空间。
	- 解决均匀分配的问题,在数据和节点之间又加入了一层,把这层称为哈希槽(slot),用于管理数据和节点之间的关系,现在就相当于节点上放的是槽,槽里放的是数据。
	- 槽解决的是粒度问题,相当于把粒度变大了,这样便于数据移动。
	- 一个集群只能有16384个槽,编号0-16383 (0-214-1)。这些槽会分配给集群中的所有主节点,分配策略没有要求。可以指定哪些编号的槽分配给哪个主节点。集群会记录节点和槽的对应关系。解决了节点和槽的关系后,接下来就需要对key求哈希值,然后对16384取余,余数是几key就落入对应的槽里。slot= CRC16(key) % 16384。以槽为单位移动数据,因为槽的数目是固定的,处理起来比较容易,这样数据移动问题就解决了。
![[Pasted image 20220725195356.png]]




