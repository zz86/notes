
## USE 法
在这里，我为你介绍一种专门用于性能监控的 USE（Utilization Saturation and Errors） 法。USE 法把系统资源的性能指标，简化成了三个类别，即使用率、饱和度以及错误数。

- 使用率，表示资源用于服务的时间或容量百分比。100% 的使用率，表示容量已经用尽或 者全部时间都用于服务。

- 饱和度，表示资源的繁忙程度，通常与等待队列的长度相关。100% 的饱和度，表示资源 无法接受更多的请求。 

- 错误数表示发生错误的事件个数。错误数越多，表明系统的问题越严重。

这三个类别的指标，涵盖了系统资源的常见性能瓶颈，所以常被用来快速定位系统资源的性 能瓶颈。这样，无论是对 CPU、内存、磁盘和文件系统、网络等硬件资源，还是对文件描 述符数、连接数、连接跟踪数等软件资源，USE 方法都可以帮你快速定位出，是哪一种系 统资源出现了性能瓶颈。
![[Pasted image 20220928185213.png|600]]

## 动态追踪
动态追踪技术，通过探针机制，来采集内核或者应用程序的运行信息，从而可以不用修改内 核和应用程序的代码，就获得丰富的信息，帮你分析、定位想要排查的问题。

![[Pasted image 20220928192008.png|700]]

在 Linux 系统中，常见的动态追踪方法，包括 ftrace、perf、eBPF 以及 SystemTap 等。 在大多数性能问题中，使用 perf 配合火焰图是一个不错的方法。如果这满足不了你的要 求，那么：

在不需要很高灵活性的场景中，使用 perf 对性能事件进行采样，然后再配合火焰图辅助 分析，就是最常用的一种方法；

而需要对事件或函数调用进行统计分析（比如观察不同大小的 I/O 分布）时，就要用 SystemTap 或者 eBPF，通过一些自定义的脚本来进行数据处理。

在新版的内核中，eBPF 和 BCC 是最灵活的动态追踪方法；

而在旧版本内核中，特别是在 RHEL 系统中，由于 eBPF 支持受限，SystemTap 往往是 更好的选择。

此外，在使用动态追踪技术时，为了得到分析目标的详细信息，一般需要内核以及应用程序 的调试符号表。动态追踪实际上也是在这些符号（包括函数和事件）上进行的，所以易读易 理解的符号，有助于加快动态追踪的过程。